---
pihole:
  replicaCount: 1

  # -- Set Pi-hole admin password
  admin:
    existingSecret: pihole-password
    password: password

  podDnsConfig:
    enabled: true
    policy: "None"
    nameservers:
      - 127.0.0.1
      - 1.1.1.2

  # -- Service configuration
  serviceDns:
    type: LoadBalancer
    loadBalancerIP: 192.168.20.110
    annotations:
      metallb.universe.tf/address-pool: server-lan-pool
      metallb.universe.tf/allow-shared-ip: pihole-svc

  serviceDhcp:
    enabled: false

  serviceWeb:
    type: LoadBalancer
    loadBalancerIP: 192.168.20.110
    annotations:
      metallb.universe.tf/address-pool: server-lan-pool
      metallb.universe.tf/allow-shared-ip: pihole-svc

  # -- DNS Configuration
  DNS1: "1.1.1.2"
  DNS2: "1.0.0.2"

  # -- Persistent storage
  persistentVolumeClaim:
    enabled: true
    size: 1Gi
    storageClass: "local-path"

  # -- Ingress settings for Traefik
  ingress:
    enabled: true
    ingressClassName: traefik
    annotations:
      traefik.ingress.kubernetes.io/router.entrypoints: web
      metallb.universe.tf/address-pool: server-lan-pool
      gethomepage.dev/enabled: "true"
      gethomepage.dev/description: "Pi-hole DNS server"
      gethomepage.dev/group: Network
      gethomepage.dev/icon: pihole.png
      gethomepage.dev/name: Pi-hole
      gethomepage.dev/widget.type: "pihole"
      gethomepage.dev/widget.url: "http://pihole.server.lan/admin"
      gethomepage.dev/pod-selector: ""
    path: /admin
    hosts:
      - pihole.server.lan
    # tls:

  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  doh:
    enabled: true
    pullPolicy: Always

  dnsmasq:
    customDnsEntries:
      - address=/sonicwall.server.lan/192.168.20.20
      - address=/pihole.server.lan/192.168.20.100

    customCnameEntries:
      - cname=sonic.ap,sonicwall.server.lan

  extraEnvVars:
    TZ: "Europe/Rome"
